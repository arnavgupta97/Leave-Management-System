<!DOCTYPE html>
<html>
<head>
<title>Manager</title>
<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
<script src="js/jquery-3.3.1.js" type="text/javascript"></script>
<script src="js/underscore.js" type="text/javascript"></script>
<script src="js/backbone.js" type="text/javascript"></script>
<style>
body {
	background-color: #cdd3c4;
	text-align: center;
	margin: 80px;
}

div {
	padding: 40px;
}
</style>
</head>
<body>
	<h2 id="header">LIST ALL LEAVES</h2>
	<div>
		<a href="ManagerPortal.html"><button type="button" class="btn btn-success">Go Back</button></a>
	</div>
	<div>
		<div id="leave-view"></div>
		<script type="text/template" id="leave-temp">
  <b>Leave ID:</b> <%=leaveId%> , <b>Number of Days for Leave:</b> <%=noOfLeavesApplied%> , <b>Remaining Leaves:</b> <%=noOfLeavesRemaining%> ,<b> Start Date:</b> <%=startDate%> , <b>Status:</b> <%=status%>
                    </script>
	</div>
	<script type="text/javascript">
		var LeaveModel = Backbone.Model.extend({
			defaults : {
				noOfLeavesApplied : null,
				noOfLeavesRemaining : null,
				startDate : "",
				status : "",
			}
		});
		var LeaveCollection = Backbone.Collection.extend({
			model : LeaveModel,
			url : 'http://localhost:8080/messenger/webapi/manager/getLeaves'
		});

		var ViewAll = Backbone.View.extend({
			el : '#leave-view',
			initialize : function() {
				this.listenTo(this.model, 'sync change', this.render);
				this.collection.fetch();
				this.render();
			},
			render : function() {
				this.collection.each(function(leave) {
					var leaveView = new LeaveView({
						model : leave
					});
					this.$el.append(leaveView.render().el); // calling render method manually..
				}, this);
				return this; // returning this for chaining..
			}
		});
		var LeaveView = Backbone.View.extend({
			//tagName : 'li',
			template : _.template($('#leave-temp').html()),
			render : function() {
				this.$el.html(this.template(this.model.toJSON()));
				return this; // returning this from render method..
			}
		});

		var leaveCollection = new LeaveCollection();
		var viewAll = new ViewAll({
			collection : leaveCollection
		});
		$(document.body).append(viewAll.render().el);
	</script>
</body>
</html>