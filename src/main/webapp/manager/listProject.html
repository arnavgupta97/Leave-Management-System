<!DOCTYPE html>
<html>
<head>
<title>Manager</title>
<link rel="stylesheet" type="text/css" href="css/bootstrap.css">
<script src="js/jquery-3.3.1.js" type="text/javascript"></script>
<script src="js/underscore.js" type="text/javascript"></script>
<script src="js/backbone.js" type="text/javascript"></script>
<script src="session.js" type="text/javascript"></script>
<script src="listProject.js" type="text/javascript"></script>
<!--  <script src="listProject.js" type="text/javascript"></script> -->
<style>
body {
	background-color: #cdd3c4;
	text-align: center;
	margin: 80px;
}
</style>
</head>
<body>
	<h2 id="header">LIST ALL PROJECTS</h2>
	<div>
		<a href="ManagerPortal.html"><button type="button"
				class="btn btn-success">Go Back</button></a>
	</div>
	<div>
		<div id="project-view"></div>
		<script type="text/template" id="project-temp">
  <b>Project ID:</b> <%=projectId%> , <b>Project Manager:</b> <%=projectManagerId%> , <b>Project Name:</b> <%=projectName%>
          <br>
          <br> 
         </script>
         <br>
	</div>
	<script type="text/javascript">
	var ProjectModel = Backbone.Model.extend({
		defaults : {
			projectId : null,
			projectManagerId : null,
			projectName : ""
		}
	});
	var ProjectCollection = Backbone.Collection.extend({
		model : ProjectModel,
		url : '/messenger/webapi/manager/getProjects'
	});

	var ViewAll = Backbone.View.extend({
		el : '#project-view',
		initialize : function() {
			this.listenTo(this.collection, 'sync change', this.render);
			this.collection.fetch();
			this.render();
		},
		render : function() {
			this.collection.each(function(project) {
				var projectView = new ProjectView({
					model : project
				});
				this.$el.append(projectView.render().el);
			}, this);
			return this; // returning this for chaining..
		}
	});
	var ProjectView = Backbone.View.extend({
		//	tagName : 'li',
		template : _.template($('#project-temp').html()),

		render : function() {
			this.$el.html(this.template(this.model.toJSON()));
			return this; // returning this from render method..
		}
	});
	var projectCollection = new ProjectCollection();
	var viewAll = new ViewAll({
		collection : projectCollection
	});
	$(document.body).append(viewAll.render().el);
	</script>
</body>
</html>